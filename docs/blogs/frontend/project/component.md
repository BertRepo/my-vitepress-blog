---
description: ğŸ’ å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶/éå—æ§ç»„ä»¶
title: å—æ§/éå—æ§ç»„ä»¶
author: Bert
date: 2025-04-01
hidden: false
comment: true
sticky: 115
top: 120
recommend: 22
tag:
  - å‰ç«¯
category:
  - å·¥ç¨‹åŒ–
---

# ğŸ¯ ç†è§£ å—æ§ç»„ä»¶ vs éå—æ§ç»„ä»¶

å—æ§/éå—æ§ç»„ä»¶æ˜¯å¤„ç†è¡¨å•å…ƒç´ çš„ä¸¤ç§ä¸åŒæ–¹å¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºæ•°æ®çš„ç®¡ç†æ–¹å¼å’Œæ›´æ–°æœºåˆ¶ã€‚

## ä¸€ã€æ ¸å¿ƒæ¦‚å¿µå¯¹æ¯”

### 1. å—æ§ç»„ä»¶ (Controlled Components)
```jsx
// å…¸å‹ä»£ç ç»“æ„
const [value, setValue] = useState('');
<input value={value} onChange={(e) => setValue(e.target.value)} />
```

å—æ§ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€å¹¶ä¸æ˜¯å°é—­çš„ï¼Œå…¶å­˜åœ¨å†…éƒ¨çŠ¶æ€å˜é‡å‘å¤–éƒ¨ç»„ä»¶æš´éœ²çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œé€šè¿‡propså®ç°çˆ¶å­ç»„ä»¶é€šä¿¡ï¼Œçˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡propsä¿®æ”¹å­ç»„ä»¶ä¸­çš„æŸä¸ªçŠ¶æ€å˜é‡ã€‚

**æ ¸å¿ƒç‰¹å¾**ï¼š
- ğŸ›ï¸ å®Œå…¨å— React çŠ¶æ€æ§åˆ¶
- ğŸ”„ é€šè¿‡ `props` å®ç°çŠ¶æ€æš´éœ²
- ğŸ“¡ æ•°æ®æµï¼šç”¨æˆ·è¾“å…¥ â†’ onChange â†’ æ›´æ–° state â†’ é‡æ–°æ¸²æŸ“

### 2. éå—æ§ç»„ä»¶ (Uncontrolled Components)
```jsx
// å…¸å‹ä»£ç ç»“æ„
const inputRef = useRef(null);
<input ref={inputRef} defaultValue="åˆå§‹å€¼" />
```

éå—æ§ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€åˆ™æ˜¯å°é—­ç»„ä»¶å†…éƒ¨çš„ï¼Œæ­¤å¤–æ²¡æœ‰ä»»ä½•å±æ€§ã€‚ä»–çš„ç»„ä»¶çŠ¶æ€ä¸å—å¤–éƒ¨ç¯å¢ƒçš„æ§åˆ¶ï¼Œç”±DOMèŠ‚ç‚¹è‡ªèº«ç»´æŠ¤ã€‚

**æ ¸å¿ƒç‰¹å¾**ï¼š
- ğŸ•³ï¸ çŠ¶æ€å°é—­åœ¨ DOM å†…éƒ¨
- ğŸ¯ é€šè¿‡ `ref` æŒ‰éœ€è·å–å€¼
- ğŸ·ï¸ æ›´æ¥è¿‘åŸç”Ÿ HTML è¡¨å•è¡Œä¸º

å› æ­¤ï¼Œæƒ³è¦å®ç°éå—æ§ç»„ä»¶å‘å—æ§ç»„ä»¶è½¬æ¢ï¼Œå°†ç»„ä»¶å†…éƒ¨çš„çŠ¶æ€å˜é‡æš´éœ²ç»™å¤–éƒ¨ç»„ä»¶å³å¯ã€‚

## äºŒã€æ·±åº¦ç‰¹æ€§åˆ†æ

### çŠ¶æ€ç®¡ç†å¯¹æ¯”
| ç»´åº¦               | å—æ§ç»„ä»¶                     | éå—æ§ç»„ä»¶               |
|--------------------|----------------------------|-------------------------|
| **çŠ¶æ€å­˜å‚¨ä½ç½®**    | React çŠ¶æ€                 | DOM èŠ‚ç‚¹                |
| **çŠ¶æ€æš´éœ²æ–¹å¼**    | é€šè¿‡ props æš´éœ²             | å®Œå…¨å°é—­                |
| **æ›´æ–°è§¦å‘æ¡ä»¶**    | æ¯æ¬¡ onChange è§¦å‘æ¸²æŸ“      | ä»…æäº¤æ—¶è·å–å€¼          |
| **é»˜è®¤å€¼è®¾ç½®**      | é€šè¿‡ `value` å±æ€§          | ä½¿ç”¨ `defaultValue`     |

### æ··åˆæ¨¡å¼å®ç°

ä½†æ˜¯å¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªç»„ä»¶æ—¢æ˜¯å—æ§ç»„ä»¶ï¼Œåˆæ˜¯éå—æ§ç»„ä»¶ï¼Œåˆ™éœ€è¦ä¿æŒä»–æ—¢å¯å®ç°ç»„ä»¶é—´çŠ¶æ€åŒæ­¥ï¼Œåˆå¯ç›´æ¥ä½¿ç”¨å†…éƒ¨çŠ¶æ€ã€‚

```jsx
function HybridComponent({ value: propValue, onChange }) {
  const [internalValue, setInternalValue] = useState(propValue);
  
  // åˆ¤æ–­æ˜¯å¦ä¸ºå—æ§æ¨¡å¼
  const isControlled = propValue !== undefined;
  const value = isControlled ? propValue : internalValue;

  const handleChange = (e) => {
    if (!isControlled) {
      setInternalValue(e.target.value);
    }
    onChange?.(e.target.value);
  };

  return <input value={value} onChange={handleChange} />;
}
```

**æ··åˆæ¨¡å¼ç‰¹ç‚¹**ï¼š
- ğŸ¤¹ åŒæ—¶æ”¯æŒå—æ§/éå—æ§ä¸¤ç§æ¨¡å¼
- ğŸ”„ ä¼˜å…ˆåˆ¤æ–­å¤–éƒ¨æ˜¯å¦ä¼ å…¥ value å±æ€§
- âš–ï¸ å†…éƒ¨ç»´æŠ¤ fallback çŠ¶æ€

## ä¸‰ã€æœ€ä½³å®è·µæŒ‡å—

### ä½•æ—¶é€‰æ‹©å—æ§ç»„ä»¶ï¼Ÿ
âœ… éœ€è¦å³æ—¶éªŒè¯ï¼ˆå¦‚å¯†ç å¼ºåº¦æ£€æŸ¥ï¼‰  
âœ… è¡¨å•å€¼ä¾èµ–å…¶ä»–ç»„ä»¶çŠ¶æ€  
âœ… éœ€è¦åŠ¨æ€ç¦ç”¨/å¯ç”¨æäº¤æŒ‰é’®  

### ä½•æ—¶é€‰æ‹©éå—æ§ç»„ä»¶ï¼Ÿ
âœ… å¤§å‹è¡¨å•æ€§èƒ½ä¼˜åŒ–ï¼ˆé¿å…é¢‘ç¹æ¸²æŸ“ï¼‰  
âœ… é›†æˆç¬¬ä¸‰æ–¹é React åº“  
âœ… ç®€å•çš„ä¸€æ¬¡æ€§æäº¤è¡¨å•  

### æ€§èƒ½ä¼˜åŒ–æŠ€å·§
```jsx
// ä¼˜åŒ–é¢‘ç¹æ›´æ–°çš„å—æ§ç»„ä»¶
const [value, setValue] = useState('');
const memoizedInput = useMemo(() => (
  <ExpensiveComponent value={value} />
), [value]);
```

## å››ã€å¸¸è§è¯¯åŒºè§£æ

âŒ **è¯¯åŒº1**ï¼š"éå—æ§ç»„ä»¶ä¸èƒ½è®¾ç½®åˆå§‹å€¼"  
ğŸ’¡ æ­£è§£ï¼šå¯ä»¥é€šè¿‡ `defaultValue` è®¾ç½®åˆå§‹å€¼

âŒ **è¯¯åŒº2**ï¼š"å—æ§ç»„ä»¶å¿…é¡»ç”¨ useState"  
ğŸ’¡ æ­£è§£ï¼šä¹Ÿå¯ä»¥ä½¿ç”¨ useReducer æˆ–å…¶ä»–çŠ¶æ€ç®¡ç†

âŒ **è¯¯åŒº3**ï¼š"ref åªèƒ½ç”¨äºéå—æ§ç»„ä»¶"  
ğŸ’¡ æ­£è§£ï¼šå—æ§ç»„ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨ ref è®¿é—® DOM èŠ‚ç‚¹

---

> ğŸ“Œ **å…³é”®æ€»ç»“**ï¼š  
> 1. å—æ§ç»„ä»¶é€šè¿‡ React çŠ¶æ€é©±åŠ¨ï¼Œé€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶çš„åœºæ™¯  
> 2. éå—æ§ç»„ä»¶ä¾èµ– DOM çŠ¶æ€ï¼Œé€‚åˆç®€å•è¡¨å•æˆ–æ€§èƒ½æ•æ„Ÿåœºæ™¯  
> 3. æ··åˆæ¨¡å¼ç»„ä»¶å¯åŒæ—¶å…¼å®¹ä¸¤ç§æ¨¡å¼ï¼Œä½†ä¼šå¢åŠ å¤æ‚åº¦


å‚è€ƒæ–‡ç« 

ğŸ‘‰ [antd mobile ä½œè€…æ•™ä½ å†™ React å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶](https://mp.weixin.qq.com/s?__biz=MzI1ODk2Mjk0Nw==&mid=2247490176&idx=1&sn=72744e3f22fc3c749e77a070c26957f4&chksm=ea0179ecdd76f0faa76a68711e0d2c881ae7143fa1d7f73fc6ac35e11b7bd89f03df0b11463d&scene=27)

